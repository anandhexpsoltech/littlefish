jQuery(document).ready(function($){setTimeout(function(){$('.tabs').tabslet();},1000,true);$('.doc').lightGallery({selector:'this',iframeMaxWidth:'80%',download:false,counter:false});$('.plan-list li.list-title').click(function(){$(this).toggleClass('active');$(this).next('.sub').slideToggle();});$('.score-wrap .cell.variation.hover1').on('hover',function(){$(this).toggleClass('show');});$('.score-wrap .cell.variation.hover').on('click',function(){$('body').addClass('show-overlay');$(this).toggleClass('show');});$('.overlay').on('click',function(){$('body').removeClass('show-overlay');$('.score-wrap .cell.variation.hover').removeClass('show');});var container=document.querySelector('.tab > ul');var inputSearch=document.querySelector('[data-ref="search-input"]');var keyupTimeout;if(container){mixer=mixitup(container,{animation:{duration:350}});$('.tabs').on('_before',function(){if(typeof mixer!=='undefined'){mixer.destroy();}});$('.tabs').on('_after',function(){$('.custom-search input').val('');$('.tab').removeClass('active');$('.tab[style*="display: block"]').addClass('active');if($('.active > ul').length){mixer=mixitup('.active > ul',{animation:{duration:350}});}});}
inputSearch.addEventListener('keyup',function(){var searchValue;$('.active .plan-list .sub').show();if(inputSearch.value.length<3){searchValue='';}else{searchValue=inputSearch.value.toLowerCase().trim();}
clearTimeout(keyupTimeout);keyupTimeout=setTimeout(function(){filterByString(searchValue);},350);});function filterByString(searchValue){if(searchValue){mixer.filter('[class*="'+searchValue+'"]');}else{mixer.filter('all');}}
var siteURL='http://www.littlefishproperties.com.au';Dropzone.options.myAwesomeDropzone={maxFilesize:1,addRemoveLinks:true,dictResponseError:'Server not Configured',init:function(){var self=this;self.options.addRemoveLinks=true;self.options.dictRemoveFile="Delete";self.on("addedfile",function(file){console.log('new file added ',file);});self.on("sending",function(file){console.log('upload started',file);$('.meter').show();});self.on("totaluploadprogress",function(progress){console.log("progress ",progress);$('.roller').width(progress+'%');});self.on("queuecomplete",function(progress){$('.meter').delay(999).slideUp(999);});self.on("removedfile",function(file){console.log(file);});}};$('.purpuleDownList .manualSign').click(function(e){var clickedthis=$(this);var ua=window.navigator.userAgent;var iOS=!!ua.match(/iPad/i)||!!ua.match(/iPhone/i);var webkit=!!ua.match(/WebKit/i);var iOSSafari=iOS&&webkit&&!ua.match(/CriOS/i);if(iOS===true&&webkit===true&&iOSSafari===true){e.preventDefault();var metaId=$(this).attr('meta-data');var userId=$(this).attr('meta-user-id');var fileName=$(this).attr('file-name');$('.uploadDragnDrop form input#meta_id').val(metaId);$('.uploadDragnDrop').addClass('purpleForm');$('.uploadDragnDrop').removeClass('greydrop');$('.uploadDragnDrop.purpleForm .dropzone').css('background-color','#d9d3eb');$('.uploadDragnDrop form div.dz-message .dzMidleCont').html('<i class="dropIcon"></i><p class="coloredText"><strong>Important:</strong> Please only upload this file; </p> <p class="coloredText">"'+fileName+'"</p><p>* All other files can be uploaded after you have uploaded the requested file.</p>');var ajaxurl=$('.adminAjax').val();$.ajax({type:"post",dataType:"json",url:ajaxurl,data:{action:"last_uploaded",metaId:metaId,userId:userId},success:function(response){var imgUrl=clickedthis.attr('href');if($('.leftUpload .uploadDragnDrop').hasClass('purpleForm')){$('.tabs ul li.active a').removeAttr('class');$('.tabs ul li.active a').attr('class','tabpurple');}else if($('.leftUpload .taskDownloadList li').length>0){if($('.leftUpload .taskDownloadList li').eq(-1).hasClass('purpuleDownList')){$('.tabs ul li.active a').removeAttr('class');$('.tabs ul li.active a').attr('class','tabpurple');}
if($('.leftUpload .taskDownloadList li').eq(-1).hasClass('BlueDownList')){$('.tabs ul li.active a').removeAttr('class');$('.tabs ul li.active a').attr('class','tabblue');}
if($('.leftUpload .taskDownloadList li').eq(-1).hasClass('greenDownList')){$('.tabs ul li.active a').removeAttr('class');$('.tabs ul li.active a').attr('class','tabgreen');}}else{$('.tabs ul li.active a').removeAttr('class');}
$(this).closest("li").remove();localStorage.setItem('task_reload',true);setTimeout(function(){location.href=imgUrl;},1000);}});$(this).closest("li").remove();}else{var metaId=$(this).attr('meta-data');var userId=$(this).attr('meta-user-id');var fileName=$(this).attr('file-name');$('.uploadDragnDrop form input#meta_id').val(metaId);$('.uploadDragnDrop').addClass('purpleForm');$('.uploadDragnDrop').removeClass('greydrop');$('.uploadDragnDrop.purpleForm .dropzone').css('background-color','#d9d3eb');$('.uploadDragnDrop form div.dz-message .dzMidleCont').html('<i class="dropIcon"></i><p class="coloredText"><strong>Important:</strong> Please only upload this file; </p> <p class="coloredText">"'+fileName+'"</p><p>* All other files can be uploaded after you have uploaded the requested file.</p>');var ajaxurl=$('.adminAjax').val();$.ajax({type:"post",dataType:"json",url:ajaxurl,data:{action:"last_uploaded",metaId:metaId,userId:userId},success:function(response){}});$(this).closest("li").remove();}});$('.tabs.tabs_default ul.horizontal li a').on('click',function(e){localStorage.setItem('activeTab',$(e.target).attr('href'));});var activeTab=localStorage.getItem('activeTab');if($(".tabs.tabs_default ul.horizontal li a").hasClass("tabgreen")||$(".tabs.tabs_default ul.horizontal li a").hasClass("tabpurple")||$(".tabs.tabs_default ul.horizontal li a").hasClass("tabblue")){setTimeout(function(){$('.tabs.tabs_default ul.horizontal li').removeClass('active');$('.tab').css('display','none');$('#tab-4.tab').css('display','block');$('.tabs.tabs_default ul li a[href="#tab-4"]').parent('li').addClass('active');},1500)}
if(window.location.href.indexOf("document-uploaded")>-1||window.location.href.indexOf("action-required")>-1||window.location.href.indexOf("request-completed")>-1||window.location.href.indexOf("file-uploaded")>-1||window.location.href.indexOf("tab-4")>-1){setTimeout(function(){$('.tabs.tabs_default ul.horizontal li').removeClass('active');$('.tab').css('display','none');$('#tab-4.tab').css('display','block');$('.tabs.tabs_default ul li a[href="#tab-4"]').parent('li').addClass('active');},1500);}else{var reload_from_tasks=localStorage.getItem('reload_from_tasks_page');if(reload_from_tasks!==null&&reload_from_tasks!==false&&reload_from_tasks!==undefined&&reload_from_tasks!=='undefined'&&reload_from_tasks!==''){setTimeout(function(){$('.tabs.tabs_default ul.horizontal li').removeClass('active');$('.tab').css('display','none');$('#tab-4.tab').css('display','block');$('.tabs.tabs_default ul li a[href="#tab-4"]').parent('li').addClass('active');localStorage.setItem('reload_from_tasks_page','');},1500);}}
$('.BlueDownList').click(function(e){var clickedthis=$(this);var ua=window.navigator.userAgent;var iOS=!!ua.match(/iPad/i)||!!ua.match(/iPhone/i);var webkit=!!ua.match(/WebKit/i);var iOSSafari=iOS&&webkit&&!ua.match(/CriOS/i);if(iOS===true&&webkit===true&&iOSSafari===true){e.preventDefault();var metaId=$(this).attr('metaid');var postId=$(this).attr('postId');var ajaxurl=$('.adminAjax').val();$.ajax({type:"post",dataType:"json",url:ajaxurl,data:{action:"downloaded_files",metaId:metaId,postId:postId},success:function(response){var imgUrl=clickedthis.find('a').attr('href');if($('.leftUpload .uploadDragnDrop').hasClass('purpleForm')){$('.tabs ul li.active a').removeAttr('class');$('.tabs ul li.active a').attr('class','tabpurple');}else if($('.leftUpload .taskDownloadList li').length>0){if($('.leftUpload .taskDownloadList li').eq(-1).hasClass('purpuleDownList')){$('.tabs ul li.active a').removeAttr('class');$('.tabs ul li.active a').attr('class','tabpurple');}
if($('.leftUpload .taskDownloadList li').eq(-1).hasClass('BlueDownList')){$('.tabs ul li.active a').removeAttr('class');$('.tabs ul li.active a').attr('class','tabblue');}
if($('.leftUpload .taskDownloadList li').eq(-1).hasClass('greenDownList')){$('.tabs ul li.active a').removeAttr('class');$('.tabs ul li.active a').attr('class','tabgreen');}}else{$('.leftUpload ul.taskDownloadList').append('<li class="GreyDownList noDownloads"><a href="javascript:void(0);" class="taskURL"><i class="TaskIcons downloadActionBtn announceIcon"></i><span>You\'re awesome, you have no task to complete</span></a></li>');$('.tabs.tabs_default ul li.active a').removeAttr('class');}
localStorage.setItem('task_reload',true);setTimeout(function(){location.href=imgUrl;},1000);},error:function(XMLHttpRequest,textStatus,errorThrown){alert("Status: "+textStatus);alert("Error: "+errorThrown);}});$(this).closest("li").remove();return false;}else{var metaId=$(this).attr('metaid');var postId=$(this).attr('postId');var ajaxurl=$('.adminAjax').val();$.ajax({type:"post",dataType:"json",url:ajaxurl,data:{action:"downloaded_files",metaId:metaId,postId:postId},success:function(response){}});$(this).closest("li").remove();setTimeout(function(){localStorage.setItem('reload_from_tasks_page','tab4');location.reload();},500);return true;}});$('#signArea').signaturePad({drawOnly:true,drawBezierCurves:true,lineTop:90});var metaId='';var fileType='';$(".signhere").click(function(e){var clientid=$(this).attr('data-clientid');var fileurl=$(this).attr('data-filepath');metaId=$(this).attr('meta-id');fileType=$(this).attr('file-type');fileType2=$(this).attr('data-filetype');$("#btnSaveSign").attr('data-filepath',fileurl);$("#btnSaveSign").attr('data-filetype',fileType2);$("#displaysignform").toggle();});$("#btnSaveSign").click(function(e){var filepath=$(this).attr('data-filepath');var datafiletype=$(this).attr('data-filetype');var userId=$('.main-container').attr(data-user-id);var post_id=$('.main-container').attr(data-post-id);html2canvas([document.getElementById('sign-pad')],{onrendered:function(canvas){var canvas_img_data=canvas.toDataURL('image/png');var img_data=canvas_img_data.replace(/^data:image\/(png|jpg);base64,/,"");if(datafiletype=='doc_file'){$.ajax({url:siteURL+'/save_sign_doc.php',data:{img_data:img_data,filepath:filepath,userId:userId,post_id:post_id,metaId:metaId,fileType:fileType},type:'post',dataType:'json',success:function(response){console.log(response);}});}else{$.ajax({url:siteURL+'/save_sign.php',data:{img_data:img_data,filepath:filepath,userId:userId,post_id:post_id,metaId:metaId,fileType:fileType},type:'post',dataType:'json',success:function(response){console.log(response);if(response==0){alert('Error in signing doc. Please try again.');}else{$("#displaysignform").hide();alert('Doc signed successfully');location.reload(true);}}});}}});});});(function()
{if(window.localStorage)
{if(localStorage.getItem('task_reload'))
{localStorage.setItem('reload_from_tasks_page','tab4');localStorage.removeItem('task_reload');window.location.reload();}}})();